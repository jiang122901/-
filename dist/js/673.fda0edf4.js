"use strict";(self["webpackChunkmyphoto"]=self["webpackChunkmyphoto"]||[]).push([[673],{61673:function(e,t,n){n.r(t),n.d(t,{default:function(){return u}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mainbox"},[e._m(0),t("el-input",{staticClass:"inputs",staticStyle:{width:"400px","margin-left":"15px"},attrs:{placeholder:"请输入角色名称进行模糊搜索","prefix-icon":"el-icon-search"},on:{input:function(t){return e.searchfun()}},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}}),t("el-button",{staticStyle:{"background-color":"#409EFF","border-radius":"0px",height:"35px","line-height":"3px",color:"white",float:"right","margin-right":"12px","margin-top":"12px"},on:{click:function(t){e.drawer=!0}}},[t("i",{staticClass:"el-icon-plus"}),e._v("添加系统角色")]),t("el-drawer",{attrs:{title:"我是标题",visible:e.drawer,"with-header":!1},on:{"update:visible":function(t){e.drawer=t}}},[t("div",[t("div",{staticClass:"logo"},[e._v("欢迎来到权限管理添加系统")]),t("el-input",{staticStyle:{"margin-top":"30px"},attrs:{placeholder:"请输入角色名称"},model:{value:e.obj.rolename,callback:function(t){e.$set(e.obj,"rolename",t)},expression:"obj.rolename"}}),t("br"),t("br"),t("el-input",{attrs:{placeholder:"请输入角色描述"},model:{value:e.obj.describe,callback:function(t){e.$set(e.obj,"describe",t)},expression:"obj.describe"}}),t("br"),t("br"),t("span",{staticStyle:{"font-size":"18px","font-weight":"600","text-align":"center",width:"450px",display:"block"}},[e._v("权限配置")]),t("el-tree",{ref:"tree",attrs:{data:e.data,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":"",props:e.defaultProps},model:{value:e.obj.powers,callback:function(t){e.$set(e.obj,"powers",t)},expression:"obj.powers"}}),t("br"),t("br"),t("span",{staticStyle:{"font-size":"18px","font-weight":"600","text-align":"center",width:"450px",display:"block"}},[e._v("请输入角色状态是否开启")]),t("div",{staticStyle:{width:"450px","text-align":"center","margin-top":"12px"}},[t("el-radio",{attrs:{label:"1"},model:{value:e.obj.status,callback:function(t){e.$set(e.obj,"status",t)},expression:"obj.status"}},[e._v("启用")]),t("el-radio",{attrs:{label:"0"},model:{value:e.obj.status,callback:function(t){e.$set(e.obj,"status",t)},expression:"obj.status"}},[e._v("禁用")])],1),t("br"),t("el-button",{staticStyle:{"margin-left":"45%","margin-top":"5%"},on:{click:e.sub}},[e._v("提交")])],1)]),t("div",{staticClass:"footbox",staticStyle:{width:"100%"}},[t("el-table",{ref:"multipleTable",staticStyle:{width:"100%","background-color":"#ECEEF5"},attrs:{data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"80"}}),t("el-table-column",{attrs:{prop:"name",label:"角色名称",width:"190"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.rolename))]}}])}),t("el-table-column",{attrs:{prop:"describe",label:"角色描述",width:"190"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.describe))]}}])}),t("el-table-column",{attrs:{prop:"powers",label:"角色权限配置",width:"190"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.getNamesByIds(e.shujulist,t.row.powers)))]}}])}),t("el-table-column",{attrs:{prop:"status",label:"角色启用状态",width:"190"},scopedSlots:e._u([{key:"default",fn:function(n){return[e._v(" "+e._s(n.row.status?"启用中":"已停用")+" "),t("div",{class:1==n.row.status?"green":"red",staticStyle:{width:"7px",height:"7px","border-radius":"50%",display:"inline-block","margin-bottom":"2px"}})]}}])}),t("el-table-column",{attrs:{prop:"lasttime",label:"最后编辑时间",width:"190"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatTimestamp(t.row.lasttime)))]}}])}),t("el-table-column",{attrs:{prop:"name",label:"操作",width:"218"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleEdit(n.row.id)}}},[t("i",{staticClass:"el-icon-edit",staticStyle:{color:"#D2D7DC","font-size":"18px"}})]),t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleDelete(n.row.id)}}},[t("i",{staticClass:"el-icon-delete",staticStyle:{color:"#D2D7DC","font-size":"18px"}})]),t("el-button",{staticStyle:{color:"#D2D7DC","font-size":"19px"},attrs:{type:"text",icon:0===n.row.status?"el-icon-video-play":"el-icon-switch-button"},on:{click:function(t){return e.xiugai(n.$index,n.row)}}})]}}])})],1),t("el-pagination",{staticStyle:{"text-align":"center","margin-top":"12px"},attrs:{background:"",layout:"prev, pager, next",total:e.total},on:{"current-change":e.def}})],1)],1)},o=[function(){var e=this,t=e._self._c;return t("span",{staticClass:"el-dropdown-link"},[e._v("  角色状态"),t("i",{staticClass:"el-icon-caret-bottom",staticStyle:{"margin-left":"55px"}})])}],s=(n(44114),n(99799)),l={data(){return{data:[{id:1,label:"首页",children:[{id:4,label:"企业管理"}]},{id:2,label:"通话统计",children:[{id:5,label:"并发统计"}]},{id:3,label:"权限管理",children:[{id:7,label:"系统角色管理"},{id:8,label:"系统用户管理"}]}],defaultProps:{children:"children",label:"label"},total:0,page:0,drawer:!1,input:"",tableData:[],getrolelists:[],shujulist:[],multipleSelection:[],cid:"",listid:"",obj:{rolename:"",describe:"",powers:"",status:""}}},created(){this.show(),this.getrolelistss()},methods:{getrolelistss(){(0,s.Lk)().then((e=>{console.log(e.data.data),this.shujulist=e.data.data}))},xiugai(e,t){console.log(e,t),(0,s.h3)({id:t.id,status:t.status?0:1}).then((e=>{this.show(),console.log(e)}))},formatTimestamp(e){const t=1e3*e,n=new Date(t),i=`${n.getFullYear()}-${n.getMonth()+1}-${n.getDate()} ${n.getHours()}:${n.getMinutes()}:${n.getSeconds()}`;return i},def(e){console.log(e),this.show(e)},searchfun(){let e={rolename:this.input};(0,s.SJ)(e).then((e=>{this.tableData=e.data.data}))},toggleSelection(e){e?e.forEach((e=>{this.$refs.multipleTable.toggleRowSelection(e)})):this.$refs.multipleTable.clearSelection()},handleSelectionChange(e){this.multipleSelection=e},show(e){(0,s.QG)(e).then((e=>{console.log(e),this.tableData=e.data.data,this.total=e.data.pagecount}))},handleDelete(e){const t=confirm("确定要删除这条记录吗？");t&&(0,s.FX)(e).then((e=>{console.log(e),this.show()}))},getlist(){(0,s.Lk)().then((e=>{this.getrolelists=e.data.data}))},getNamesByIds(e,t){const n=t.split(",").map((e=>parseInt(e.trim()))),i=[];return e.forEach((e=>{n.includes(e.id)&&i.push(e.name)})),i.join(", ")},sub(){let e=this.$refs.tree.getCheckedKeys().join(",");if(this.obj.powers=e,console.log(this.obj.powers),null==this.id&&""==this.cid){let e={rolename:this.obj.rolename,describe:this.obj.describe,powers:this.obj.powers,status:this.obj.status};(0,s.pY)(e).then((e=>{console.log(e),this.show(),this.obj={rolename:"",describe:"",powers:"",status:""}})).catch((e=>{console.error("添加失败:",e)}))}else{let e={id:this.cid,rolename:this.obj.rolename,describe:this.obj.describe,powers:this.obj.powers,status:this.obj.status};(0,s.Cu)(e).then((e=>{console.log(e),this.show(),this.obj={rolename:"",describe:"",powers:"",status:""},this.cid="",this.show()})).catch((e=>{console.error("修改失败:",e)}))}},handleEdit(e){console.log(e),this.cid=e,(0,s.AK)(this.cid).then((e=>{console.log(e),this.obj.rolename=e.data.rolename,this.obj.describe=e.data.describe,this.obj.powers=e.data.powers,this.obj.status=e.data.status})),this.drawer=!0},getlast(e){console.log(e),this.listid=e,(0,s.Lk)(this.listid).then((e=>{console.log(e)}))}}},r=l,a=n(81656),c=(0,a.A)(r,i,o,!1,null,"e36bfc68",null),u=c.exports},99799:function(e,t,n){n.d(t,{$P:function(){return c},AK:function(){return g},BF:function(){return u},C7:function(){return r},Cu:function(){return m},FX:function(){return b},Lk:function(){return w},QG:function(){return h},SJ:function(){return p},aV:function(){return d},h3:function(){return x},iD:function(){return s},kz:function(){return l},pY:function(){return f},vC:function(){return a},vq:function(){return o}});var i=n(40412);function o(){return new Promise((e=>{(0,i.V)("index.php/index/index/getcode").then((t=>{e(t)}))}))}function s(e){return new Promise((t=>{(0,i.V)("/index.php/index/index/login",e).then((e=>{t(e)}))}))}function l(e){return new Promise((t=>{(0,i.V)("/index.php/index/index/register",e).then((e=>{t(e)}))}))}function r(e){return new Promise((t=>{(0,i.V)("/index.php/index/call/getsuperes",e).then((e=>{t(e)}))}))}function a(e){return new Promise((t=>{(0,i.$)("/index.php/index/call/getsearches",e).then((e=>{t(e)}))}))}function c(e){return new Promise((t=>{(0,i.$)(`/index.php/index/call/getsuperbyid?id=${e}`).then((e=>{t(e)}))}))}function u(e){return new Promise((t=>{(0,i.$)("/index.php/index/call/addsuper",e).then((e=>{t(e)}))}))}function d(e){return new Promise((t=>{(0,i.$)("/index.php/index/call/upsuperstatus",e).then((e=>{t(e)}))}))}function h(e){return new Promise((t=>{(0,i.$)("/index.php/index/role/getroleslist",{page:e}).then((e=>{t(e)}))}))}function p(e){return new Promise((t=>{(0,i.$)("/index.php/index/role/getsearchroles",e).then((e=>{t(e)}))}))}function b(e){return new Promise((t=>{(0,i.$)("/index.php/index/role/delroles?id="+e).then((e=>{t(e)}))}))}function f(e){return new Promise((t=>{(0,i.$)("/index.php/index/role/addroles",e).then((e=>{t(e)}))}))}function m(e){return new Promise((t=>{(0,i.$)("/index.php/index/role/uproles",e).then((e=>{t(e)}))}))}function g(e){return new Promise((t=>{(0,i.$)("/index.php/index/role/getrolesbyid?id="+e).then((e=>{t(e)}))}))}function w(){return new Promise((e=>{(0,i.$)("/index.php/index/call/getmenu").then((t=>{e(t)}))}))}function x(e){return new Promise((t=>{(0,i.$)("/index.php/index/role/stoproles",e).then((e=>{t(e)}))}))}}}]);
//# sourceMappingURL=673.fda0edf4.js.map